cmake_minimum_required(VERSION 3.5.1)

set(DIR ${FLASHLIGHT_CORE_DIR}/test)
set(LIBS flashlight ${CMAKE_DL_LIBS})
build_test(${DIR}/autograd/AutogradTest.cpp ${LIBS} "")
build_test(${DIR}/common/DevicePtrTest.cpp ${LIBS} "")
build_test(${DIR}/common/DynamicBenchmarkTest.cpp ${LIBS} "")
build_test(${DIR}/common/HistogramTest.cpp ${LIBS} "")
build_test(${DIR}/common/LoggingTest.cpp ${LIBS} "")
build_test(${DIR}/common/SerializationTest.cpp ${LIBS} "")
build_test(${DIR}/optim/OptimTest.cpp ${LIBS} "")
build_test(${DIR}/memory/CachingMemoryManagerTest.cpp ${LIBS} "")
build_test(${DIR}/memory/MemoryFrameworkTest.cpp ${LIBS} "")
build_test(${DIR}/memory/MemoryInitTest.cpp ${LIBS} "")
build_test(${DIR}/nn/ModuleTest.cpp ${LIBS} "")
build_test(${DIR}/nn/NNSerializationTest.cpp ${LIBS} "")
build_test(${DIR}/nn/NNUtilsTest.cpp ${LIBS} "")
build_test(${DIR}/dataset/DatasetTest.cpp ${LIBS} "")
build_test(${DIR}/dataset/DatasetUtilsTest.cpp ${LIBS} "")
build_test(${DIR}/meter/MeterTest.cpp ${LIBS} "")
if (FL_BUILD_DISTRIBUTED)
  build_test(${DIR}/distributed/AllReduceTest.cpp ${LIBS} "")
endif ()
if (FL_BUILD_CONTRIB)
  build_test(${DIR}/contrib/modules/ContribModuleTest.cpp ${LIBS} "")
  build_test(${DIR}/contrib/modules/ContribSerializationTest.cpp ${LIBS} "")
endif ()
